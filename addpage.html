<!DOCTYPE html>
<html lang="en">
  <head>
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="booktablestyle.css" />
    <link rel="stylesheet" href="switch.css" />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Add</title>
  </head>
  <body>
    <div class= "wholehead" id="head">
      <div class="header" id="myHeader">
        <h2>Working Talent

        </h2>
      </div>


      <div id="navbarwt" class="navbarwt">

        <div class="dropdownwt">
          <button class="dropbtnwt" onclick="location.href='showbooks.html'">
            Home
          </button>
        </div>

        <div class="dropdownwt">
          <button class="dropbtnwt">
            My account
            
          </button>
          <div class="dropdown-contentwt">
            <a href="userportal.html">User Portal</a>
            <a href="accountSettings.html">Account Settings</a>
          </div>
        </div>
        <div class="dropdownwt" id="adminmenu">
          <button class="dropbtnwt">
            Admin
            
          </button>
          <div class="dropdown-contentwt">
            <a href="adminportal.html">Admin portal</a>
            <a href="booktable.html">Book Table</a>
            <a href="bookcopy.html">Copy Table</a>
            <a href="userstable.html"> User Table</a>
            <a href="reservation.html"> Reservation Table</a>
            <a href="borrowedcopy.html"> Borrowedcopy Table</a>
            <a href="addpage.html">Add Books/Users</a>
          </div>
        </div>
        <form align="right" name="form1" method="post" onclick="deleteTokenDataBase()" action = "inlogapage.html">
          <label class="logoutLblPos">
            <input
              name="submit2"
              type="submit"
              id="submit2"
              value="Log out"
              class="btn btn-success"
            />
          </label>
        </form>
      </div>
    </div>
    

    <section class="py-5 my-5">
      <div class="container">
        <h1 class="mb-5">Administration</h1>
        <div class="bg-white shadow rounded-lg d-block d-sm-flex">
          <div class="profile-tab-nav border-right">
            <div class="p-4">
              <div class="img-circle text-center mb-3">
                <img src="img/user2.png" alt="Image" class="shadow">
              </div>
              <h4 class="text-center" id="ProfileName"></h4>
            </div>
            <div class="nav flex-column nav-pills" id="v-pills-tab" role="tablist" aria-orientation="vertical">
              <a class="nav-link active" id="account-tab" data-toggle="pill" href="#account" role="tab" aria-controls="account" aria-selected="true">
                <i class="fa fa-user text-center mr-1"></i> 
                Add User
              </a>
              <a class="nav-link" id="password-tab" data-toggle="pill" href="#addBook" role="tab" aria-controls="password" aria-selected="false">
                <i class="fa fa-book text-center mr-1"></i> 
                Add Book
              </a>
            </div>
          </div>
          <div class="tab-content p-4 p-md-5" id="v-pills-tabContent">
            <div class="tab-pane fade show active" id="account" role="tabpanel" aria-labelledby="account-tab">
              <h3 class="mb-4">Add New Employee</h3>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                      <label>Full Name</label>
                      <input id="fullName" type="text" class="form-control" placeholder="Full Name">
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                      <label>Email</label>
                      <input id="email"type="email" class="form-control" placeholder="Email">
                  </div>
                </div>
                <div class="col-md-6">
                    <div class="form-group">
                        <label>Username</label>
                        <input id="username"type="text" class="form-control" placeholder="Username">
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                        <label>Password</label>
                        <input id="password"type="text" class="form-control" placeholder="Password">
                    </div>
                  </div>
              </div>
              <div>
                <button class="btn btn-success" onclick="addUser()">Add Employee</button>
                <button class="btn btn-light" onclick="cancelUser()">Cancel</button>
              </div>
            </div>
            <div class="tab-pane fade" id="addBook" role="tabpanel" aria-labelledby="password-tab">
              <h3 class="mb-4">Add New Book</h3>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                      <label>Title</label>
                      <input id= "title" type="text" class="form-control" placeholder="Title">
                  </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group">
                        <label>Add amount</label>
                        <input id= "amountbooks" type="number" class="form-control" placeholder="Amount" min="1">
                    </div>
                  </div>
              </div>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                      <label>Author</label>
                      <input id= "author" type="text" class="form-control" placeholder="Author">
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                      <label>ISBN</label>
                      <input id= "isbn" type="text" class="form-control" placeholder="ISBN">
                  </div>
                </div>
              </div>
              <div>
                <button class="btn btn-success" onclick="addBook()">Add Book</button>
                <button class="btn btn-light" onclick="cancelBook()">Cancel</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>


    <footer class="w3-container w3-teal">
      <br>
      <br>
      <h4>Working Talent Dev</h4>
      <br>
      <br>
    </footer>
  </body>
    <script>
  function deleteTokenDataBase(){

fetch('http://localhost:8080/user/logout/empty/token', {    
    headers: {
            "Content-Type": "application/json",
            Authorization: localStorage.getItem("token"),
        }
    })
    .then(res => res.json())
    .then(data => {
        console.log('Token is empty in the database');
        
       
    })
    .then(localStorage.clear())
   
}
    
        function addBook() {
      // Formulier uitlezen
      
      let bookNameInvoer = document.getElementById("title").value;
      let authorNameInvoer = document.getElementById("author").value;
      let ISBNInvoer = document.getElementById("isbn").value;
      let amountBooks = document.getElementById("amountbooks").value;

      // Javascript object
      let newBook = {
        title: bookNameInvoer,
        author: authorNameInvoer,
        isbn: ISBNInvoer,
      };

      // Fetch call
      fetch("http://localhost:8080/book/save", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: localStorage.getItem("token"),
        },
        body: JSON.stringify(newBook),
      })
        .then((res) => {
          console.log(res.json().validationMessages)
          addCopies()
        })
        .catch((error) => {
            alert("Something went Wrong, check the input fields!");
        });


    }

function addCopies(){
  let ISBNInvoer = document.getElementById("isbn").value;
  let amountBooks = document.getElementById("amountbooks").value;

  let newCopies ={
    isbn: ISBNInvoer,
    amount: amountBooks,
  }

  fetch("http://localhost:8080/book/isbn/savecopy", {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: localStorage.getItem("token"),
        },
        body: JSON.stringify(newCopies),
      })
      .then((res) => {
          alert("Book added");
        })
        .catch((error) => {
            alert("Something went Wrong, check the input fields!");
        });
        cancelBook();
}

    function addUser() {
    //formulier uitlezen
    let nameInput = document.getElementById("fullName").value;
    let emailInput = document.getElementById("email").value;
    let usernameInput = document.getElementById("username").value;
    let passwordInput = document.getElementById("password").value;


    // Javascript object
    let newUser = {
      name: nameInput,
      email: emailInput,
      username: usernameInput,
      password: passwordInput,
      admin: false,
      active: false,
    };

    // Fetch call
    fetch('http://localhost:8080/user/save', {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": localStorage.getItem('token')
      },
      body: JSON.stringify(newUser),
    })
      .then((res) => {
        alert("Employee has been added");

      })
      .catch((error) => {
        alert("Something went wrong, check all input fields");
      });

    cancelUser();

  }

  function cancelUser(){

    document.getElementById("fullName").value = "";
    document.getElementById("email").value = "";
    document.getElementById("username").value = "";
    document.getElementById("password").value = "";

  }

  function cancelBook(){
    document.getElementById("title").value = "";
    document.getElementById("author").value = "";
    document.getElementById("isbn").value = "";
  }

  window.onscroll = function() {myFunction2()};

var head = document.getElementById("navbarwt");
var sticky = head.offsetTop;

function myFunction2() {
  if (window.pageYOffset > sticky) {
    head.classList.add("sticky");
  } else {
    head.classList.remove("sticky");
  }
  
}
    </script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
</html>
