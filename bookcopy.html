<!DOCTYPE html>
<html lang="en">
  <head class="flex-container">
    <link rel="stylesheet" href="bookcopystyle.css" />
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css" />
    <link rel="stylesheet" href="booktablestyle.css" />
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>

    <title>Book table</title>
  </head>

  <body>
    <header class="w3-container w3-teal">
      <h1>Working Talent</h1>
    </header>
    <div class="topnav">
      <a class="" href="adminportal.html">Admin Portal</a>
      <a class="" href="booktable.html">Book table</a>
      <a class="active">Copy table</a>
      <a class="" href="userstable.html"> User Table</a>
      <a class="" href="reservation.html"> Reservation Table</a>
      <a class="" href="borrowedcopy.html"> Borrowedcopy Table</a>
    </div>
    <div class="container">
      <table class="table styled-table">
        <thead>
          <tr>
            <th>Working Talent Id</th>
            <th>Title</th>
            <th>Number of times borrowed</th>
            <th>availability</th>
          </tr>
        </thead>
        <tbody id="allBookCopiesTable"></tbody>
      </table>
    </div>

    <div class="flex-container"></div>

    <footer class="w3-container w3-teal">
      <h5>Footer</h5>
      <p>Footer information goes here</p>
    </footer>
  </body>

  <script>
    /**
     * This method generates the table of the book copies:
     * The bookcopy Id and the bookId.
     *
     *
     *
     */

    function showAllBookCopies() {
      fetch("http://localhost:8080/bookcopies",{
      method: "GET",
            headers: {
                "Content-Type": "application/json",
                "Authorization": localStorage.getItem('token')
            },
        })
        .then((res) => res.json())
        .then((data) => {
          let bookcopiesHtml = "";
          data.forEach((bookcopy) => {
            bookcopiesHtml += `
                <tr>
                    <td style = "display : none" >${bookcopy.id}</td>
                    <td>${bookcopy.workingTalentId}</td>
                    <td>${bookcopy.bookTitle}</td>
                    <td>${bookcopy.timesBorrowed}</td>
                    <td></td>
                </tr>
                `;
          });
          document.getElementById("allBookCopiesTable").innerHTML =
            bookcopiesHtml;
          //console.log(this.responseText);
        });
    }

    function checkavailability(bookCopyId) {
      fetch(`http://localhost:8080/current/${bookCopyId}/borrowedcopies`)
        .then((res) => res.json())
        .then((data) => {
          let bookcopiesHtml = "";
          data.forEach((bookcopy) => {
            bookcopiesHtml += `
                <tr>
                    <td style = "display : none" >${bookcopy.id}</td>
                    <td>${bookcopy.workingTalentId}</td>
                    <td>${bookcopy.bookTitle}</td>
                    <td>${bookcopy.timesBorrowed}</td>
                   
                </tr>
                `;
          });
          document.getElementById("allBookCopiesTable").innerHTML =
            bookcopiesHtml;
          //console.log(this.responseText);
        });
    }
    showAllBookCopies();
  </script>
</html>
