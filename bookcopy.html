<!DOCTYPE html>
<html lang="en">
<head class="flex-container">
    <link rel="stylesheet" href="bookcopystyle.css">
    <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
    <link rel="stylesheet" href="booktablestyle.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book table</title>
</head>

<body>
 <header class="w3-container w3-teal">
  <h1>
    Working Talent
  </h1>
 </header>
 <div class="topnav">
  <a class="" href="booktable.html">Book table</a>
  <a class="active" href="bookcopy.html">Copy table</a>
  <a class="" href="Userstable.html"> User Table</a>
</div>
  <div class = "container"  >
    <table class = "styled-table">
      <thead>
          <tr>
              <th>ID</th>
              <th>Book_id</th>
          </tr>
      </thead>
      <tbody id="allBookCopiesTable">
          

      </tbody>
  </table>
  </div>
  
  
  <div class = "flex-container">
    <div class = "container">
      <label for="bookid">Book ID</label>
      <input  id="bookid" type="text">
      <br>
      <label for="bookName">Title</label>
      <input type="text" id="bookName">
      <br>
      <label for="authorName">author</label>
      <input id="authorName" type="text">
      <br>
      <label for="quantity">ISBN</label>
      <input type="text" id="quantity">
      <br>
    </div>
    
    <div class = "container">
      <button class= "add-book-button button"type="button" onclick="addBook()">add book</button>
      <br>
      <button class= "update-book-button button" type = "button" onclick = "updateBook()">edit book</button>
      <br>
      <button class= "delete-book-button button" type = "button" onclick = "deleteBook()">delete book</button>
    </div>
  </div>

  <footer class="w3-container w3-teal">
    <h5>Footer</h5>
    <p>Footer information goes here</p>
  </footer>
  </body>




  <script >
      function showAllBookCopies(){
        fetch('http://localhost:8080/bookcopies')
        .then(res => res.json())
        .then(data =>{
          console.log(data);
          let bookcopiesHtml = '';
          data.forEach(bookcopy => {
                bookcopiesHtml += `
                <tr>
                    <td>${bookcopy.id}</td>
                    <td>${bookcopy.bookId}</td>
                </tr>
                `
            });
                      document.getElementById("allBookCopiesTable").innerHTML = bookcopiesHtml;
              //console.log(this.responseText);
          })
         }
  
      function addBook() {
          // Formulier uitlezen
          let bookIdInvoer = document.getElementById("bookid").value;
          let bookNameInvoer = document.getElementById("bookName").value;
          let authorNameInvoer = document.getElementById("authorName").value;
          let ISBNInvoer = document.getElementById("quantity").value;
  
          // Javascript object
          let newBook = {
            id: bookIdInvoer,
            title: bookNameInvoer,
            author: authorNameInvoer,
            isbn: ISBNInvoer,
          };
  
          // Fetch call
          fetch("http://localhost:8080/book/save", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(newBook),
          })
            .then((res) => {
              showAllBooks();
              alert("Is goedgegaan");
            })
            .catch((error) => {
              alert("Er is iets fouts gegaan");
            });
        }
  
  
        function updateBook() {
          // Formulier uitlezen
          let bookIdInvoer = document.getElementById("bookid").value;
          let bookNameInvoer = document.getElementById("bookName").value;
          let authorNameInvoer = document.getElementById("authorName").value;
          let ISBNInvoer = document.getElementById("quantity").value;
          // Javascript object
          let newInfo = {
            id: bookIdInvoer,
            title: bookNameInvoer,
            author: authorNameInvoer,
            isbn: ISBNInvoer,
          };
  
          // Fetch call
          fetch(`http://localhost:8080/book/update/${bookIdInvoer}`, {
            method: "PUT",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(newInfo),
          })
            .then((res) => {
                
              alert("Is goedgegaan");
              showAllBooks();
            })
            .catch((error) => {
              alert("Er is iets fouts gegaan");
            });
        }
  
        function deleteBook() {
          // Formulier uitlezen
          let bookIdInvoer = document.getElementById("bookid").value;
          // Javascript object
          let delInfo = {
            id: bookIdInvoer,
          };
  
          // Fetch call
          fetch(`http://localhost:8080/book/delete/${bookIdInvoer}`, {
            method: "DELETE",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify(delInfo),
          })
            .then((res) => {
                
              alert("Is goedgegaan");
              showAllBooks();
            })
            .catch((error) => {
              alert("Er is iets fouts gegaan");
            });
            
        }
        showAllBookCopies();
  
  </script>
</html>